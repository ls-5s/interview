<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿæ—¥å¿«ä¹å¼¹å¹•ç¥ç¦</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            overflow: hidden;
            background-color: #0a0a0a;
            background-image: radial-gradient(#f38181 1px, transparent 1px);
            background-size: 20px 20px;
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            position: relative;
        }

        /* ä¸»æ ‡é¢˜æ ·å¼ */
        .main-title {
            position: absolute;
            top: 20%;
            font-size: 48px;
            font-weight: bold;
            color: #ff6b6b;
            text-align: center;
            text-shadow: 0 0 10px rgba(255, 107, 107, 0.7), 0 0 20px rgba(255, 107, 107, 0.5);
            z-index: 100;
            opacity: 0;
            animation: fadeIn 1.5s ease-out forwards;
        }

        /* ç”Ÿæ—¥å›¾æ ‡å®¹å™¨ */
        .birthday-icons {
            position: absolute;
            top: 40%;
            display: flex;
            gap: 40px;
            z-index: 100;
            opacity: 0;
            animation: fadeIn 1.5s ease-out 0.5s forwards;
        }

        /* å›¾æ ‡æ ·å¼ */
        .birthday-icon {
            font-size: 64px;
            transform: rotate(0deg);
            animation: float 4s ease-in-out infinite;
        }

        /* å›¾æ ‡å»¶è¿ŸåŠ¨ç”»æ•ˆæœ */
        .birthday-icon:nth-child(1) { animation-delay: 0s; }
        .birthday-icon:nth-child(2) { animation-delay: 0.5s; }
        .birthday-icon:nth-child(3) { animation-delay: 1s; }

        #danmaku-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 50;
            overflow: hidden;
            pointer-events: none;
        }

        /* å¼¹å¹•æ ·å¼ - Bç«™é£æ ¼ */
        .danmaku {
            position: absolute;
            white-space: nowrap;
            color: white;
            font-weight: bold;
            text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
            opacity: 0;
            transform: translateX(100%);
            animation: danmakuMove linear;
            cursor: pointer;
            user-select: none;
            z-index: 50;
            pointer-events: auto;
            will-change: transform, opacity;
        }

        /* æµ®åŠ¨åŠ¨ç”»æ•ˆæœ - ä»…ç”¨äºå›¾æ ‡ */
        @keyframes float {
            0% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-10px) rotate(1deg); }
            100% { transform: translateY(0px) rotate(0deg); }
        }

        /* æ·¡å…¥åŠ¨ç”» */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* å¼¹å¹•æ»šåŠ¨åŠ¨ç”» - ä¿®å¤ç‰ˆï¼Œç¡®ä¿èƒ½æ»šåŠ¨åˆ°æœ€å·¦è¾¹ */
        @keyframes danmakuMove {
            0% {
                transform: translateX(100vw);
                opacity: 0;
            }
            5% {
                opacity: 1;
            }
            95% {
                opacity: 1;
            }
            100% {
                transform: translateX(calc(-100% - 100px));
                opacity: 0;
            }
        }

        /* å¼¹å¹•é¢œè‰²å˜ä½“ */
        .danmaku.red { color: #ff6b6b; }
        .danmaku.yellow { color: #ffe66d; }
        .danmaku.blue { color: #4ecdc4; }
        .danmaku.green { color: #45b7d1; }
        .danmaku.purple { color: #96ceb4; }

        /* å¼¹å¹•å­—ä½“å¤§å°å˜ä½“ */
        .danmaku.small { font-size: 14px; }
        .danmaku.medium { font-size: 18px; }
        .danmaku.large { font-size: 22px; }
        .danmaku.extra-large { font-size: 28px; }
    </style>
</head>

<body>
    <!-- ä¸»æ ‡é¢˜ -->
    <div class="main-title">ææ´‹ç”Ÿæ—¥å¿«ä¹ï¼</div>

    <!-- ç”Ÿæ—¥å›¾æ ‡ -->
    <div class="birthday-icons">
        <div class="birthday-icon">ğŸ‚</div>
        <div class="birthday-icon">ğŸ‰</div>
        <div class="birthday-icon">ğŸ</div>
    </div>

    <div id="danmaku-container"></div>
    <script>
        // ç”Ÿæ—¥å¿«ä¹ç¥ç¦è¯­åˆ—è¡¨
        const birthdayWishes = [
            "ç”Ÿæ—¥å¿«ä¹ï¼ğŸ‚",
            "ç”Ÿæ—¥å¿«ä¹ï¼ğŸ‰",
            "ç”Ÿæ—¥å¿«ä¹ï¼ğŸ",
            "ææ´‹ç”Ÿæ—¥å¿«ä¹ï¼",
            "ç”Ÿæ—¥å¿«ä¹ï¼æ„¿ä½ å²å²å¹³å®‰ï¼",
            "ç”Ÿæ—¥å¿«ä¹ï¼æ„¿æ‰€æœ‰ç¾å¥½éƒ½å›´ç»•ç€ä½ ï¼",
            "ç”Ÿæ—¥å¿«ä¹ï¼ä»Šå¤©æ˜¯å±äºä½ çš„ç‰¹åˆ«æ—¥å­ï¼",
            "ç”Ÿæ—¥å¿«ä¹ï¼æ„¿ä½ çš„äººç”Ÿå……æ»¡é˜³å…‰ï¼",
            "ç”Ÿæ—¥å¿«ä¹ï¼æ°¸è¿œå¼€å¿ƒï¼",
            "ç”Ÿæ—¥å¿«ä¹ï¼å¿ƒæƒ³äº‹æˆï¼",
            "ç”Ÿæ—¥å¿«ä¹ï¼é’æ˜¥æ°¸é©»ï¼",
            "ç”Ÿæ—¥å¿«ä¹ï¼èº«ä½“å¥åº·ï¼",
            "ç”Ÿæ—¥å¿«ä¹ï¼äº‹ä¸šæœ‰æˆï¼",
            "ç”Ÿæ—¥å¿«ä¹ï¼å®¶åº­ç¾æ»¡ï¼",
            "ç”Ÿæ—¥å¿«ä¹ï¼ç¬‘å£å¸¸å¼€ï¼"
        ];

        // å¼¹å¹•é¢œè‰²ç±»å
        const danmakuColors = ['', 'red', 'yellow', 'blue', 'green', 'purple'];
        
        // å¼¹å¹•å¤§å°ç±»å
        const danmakuSizes = ['small', 'medium', 'large', 'extra-large'];

        const container = document.getElementById("danmaku-container");
        let containerWidth = window.innerWidth;
        let containerHeight = window.innerHeight;
        
        // å¼¹å¹•è½¨é“æ•°é‡ - æ ¹æ®å±å¹•é«˜åº¦è®¡ç®—
        const trackHeight = 40; // æ¯ä¸ªè½¨é“çš„é«˜åº¦
        let trackCount = Math.floor(containerHeight / trackHeight);
        const tracks = []; // è·Ÿè¸ªæ¯ä¸ªè½¨é“çš„çŠ¶æ€

        // åˆå§‹åŒ–è½¨é“æ•°ç»„
        function initTracks() {
            tracks.length = 0;
            for (let i = 0; i < trackCount; i++) {
                tracks.push({ occupied: false, lastDanmakuTime: 0 });
            }
        }

        // ç­‰å¾…3ç§’åå¼€å§‹ç”Ÿæˆå¼¹å¹•
        setTimeout(() => {
            initTracks();
            
            // åˆå§‹ç”Ÿæˆä¸€æ‰¹å¼¹å¹•
            for (let i = 0; i < 20; i++) {
                setTimeout(() => {
                    createDanmaku();
                }, i * 150);
            }
            
            // æŒç»­ç”Ÿæˆæ–°å¼¹å¹•
            setInterval(() => {
                createDanmaku();
            }, 250);
        }, 3000);

        // åˆ›å»ºå•ä¸ªå¼¹å¹•çš„å‡½æ•°
        function createDanmaku() {
            // åˆ›å»ºå¼¹å¹•å…ƒç´ 
            const danmaku = document.createElement("div");
            danmaku.className = "danmaku";

            // éšæœºé€‰æ‹©ç”Ÿæ—¥ç¥ç¦
            const randomWish = birthdayWishes[Math.floor(Math.random() * birthdayWishes.length)];
            danmaku.textContent = randomWish;

            // éšæœºé€‰æ‹©é¢œè‰²
            const randomColor = danmakuColors[Math.floor(Math.random() * danmakuColors.length)];
            if (randomColor) {
                danmaku.classList.add(randomColor);
            }

            // éšæœºé€‰æ‹©å¤§å°
            const randomSize = danmakuSizes[Math.floor(Math.random() * danmakuSizes.length)];
            danmaku.classList.add(randomSize);

            // æ·»åŠ åˆ°DOMä»¥è·å–å®é™…å®½åº¦
            container.appendChild(danmaku);
            
            // å¼ºåˆ¶é‡æ’ä»¥è·å–æ­£ç¡®çš„å®½åº¦
            danmaku.offsetWidth; // è§¦å‘é‡æ’
            
            // è·å–å¼¹å¹•å®é™…å®½åº¦
            const danmakuWidth = danmaku.offsetWidth;
            
            // æ ¹æ®å¼¹å¹•é•¿åº¦å’Œè§†å£å®½åº¦è°ƒæ•´æ»šåŠ¨é€Ÿåº¦ï¼Œç¡®ä¿å¼¹å¹•èƒ½å®Œå…¨æ»šåŠ¨åˆ°æœ€å·¦è¾¹
            const baseDuration = 12;
            const lengthFactor = Math.max(1, Math.min(3, (danmakuWidth + containerWidth) / 500)); // åŸºäºé•¿åº¦å’Œè§†å£å®½åº¦çš„ç³»æ•°
            const randomFactor = 0.5 + Math.random() * 1;
            const duration = baseDuration / randomFactor;
            danmaku.style.animationDuration = `${duration}s`;

            // æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„è½¨é“
            let trackIndex = findAvailableTrack();
            
            // å¦‚æœæ²¡æœ‰æ‰¾åˆ°è½¨é“ï¼Œéšæœºé€‰æ‹©ä¸€ä¸ª
            if (trackIndex === -1) {
                trackIndex = Math.floor(Math.random() * trackCount);
            }
            
            // æ ‡è®°è½¨é“çŠ¶æ€
            tracks[trackIndex].occupied = true;
            tracks[trackIndex].lastDanmakuTime = Date.now();
            
            // è®¾ç½®å¼¹å¹•èµ·å§‹ä½ç½® - ç¡®ä¿ä»æœ€å³è¾¹å®Œå…¨çœ‹ä¸åˆ°çš„ä½ç½®å¼€å§‹
            danmaku.style.top = `${trackIndex * trackHeight + 5}px`;
            
            // ä¸éœ€è¦è®¾ç½®leftï¼Œè®©CSSåŠ¨ç”»æ§åˆ¶ä½ç½®

            // è®¾ç½®åŠ¨ç”»å»¶è¿Ÿï¼Œå¢åŠ éšæœºæ€§
            const delay = Math.random() * 0.5;
            danmaku.style.animationDelay = `${delay}s`;

            // åŠ¨ç”»ç»“æŸåç§»é™¤å¼¹å¹•å¹¶é‡Šæ”¾è½¨é“
            setTimeout(() => {
                if (document.body.contains(danmaku)) {
                    danmaku.style.opacity = 0;
                    setTimeout(() => {
                        if (document.body.contains(danmaku)) {
                            danmaku.remove();
                        }
                    }, 300);
                }
                tracks[trackIndex].occupied = false;
            }, (duration + delay) * 1000);

            // æ·»åŠ ç‚¹å‡»å…³é—­åŠŸèƒ½
            danmaku.addEventListener('click', function() {
                this.style.opacity = 0;
                setTimeout(() => {
                    if (document.body.contains(this)) {
                        this.remove();
                    }
                    tracks[trackIndex].occupied = false;
                }, 300);
            });
        }

        // æŸ¥æ‰¾å¯ç”¨è½¨é“çš„å‡½æ•°
        function findAvailableTrack() {
            const currentTime = Date.now();
            
            // ä¼˜å…ˆæ‰¾å®Œå…¨ç©ºé—²çš„è½¨é“
            for (let i = 0; i < trackCount; i++) {
                if (!tracks[i].occupied) {
                    return i;
                }
            }
            
            // å¦‚æœæ²¡æœ‰å®Œå…¨ç©ºé—²çš„è½¨é“ï¼Œæ‰¾é—´éš”æ—¶é—´è¾ƒé•¿çš„è½¨é“
            let bestTrackIndex = -1;
            let maxInterval = 0;
            
            for (let i = 0; i < trackCount; i++) {
                const interval = currentTime - tracks[i].lastDanmakuTime;
                if (interval > maxInterval) {
                    maxInterval = interval;
                    bestTrackIndex = i;
                }
            }
            
            return bestTrackIndex;
        }

        // çª—å£å¤§å°æ”¹å˜æ—¶é‡æ–°è®¡ç®—å®¹å™¨å¤§å°
        window.addEventListener('resize', function() {
            // é‡æ–°è·å–å®¹å™¨å°ºå¯¸
            containerWidth = window.innerWidth;
            containerHeight = window.innerHeight;
            
            // é‡æ–°è®¡ç®—è½¨é“æ•°é‡
            const newTrackCount = Math.floor(containerHeight / trackHeight);
            
            // å¦‚æœè½¨é“æ•°é‡å˜åŒ–ï¼Œé‡æ–°åˆå§‹åŒ–
            if (newTrackCount !== trackCount) {
                trackCount = newTrackCount;
                initTracks();
            }
        });
    </script>
</body>

</html>